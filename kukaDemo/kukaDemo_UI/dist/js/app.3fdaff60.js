webpackJsonp([1],{"+VGo":function(t,s){},0:function(t,s,e){t.exports=e("NHnr")},1:function(t,s){},"3qvW":function(t,s,e){t.exports=e.p+"img/chainstep.e5690373.svg"},NHnr:function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var n=e("/5sW"),a=e("Sgar"),i={name:"ShippingProgress",props:{steps:Array},methods:{completed:function(t){var s="SPAN"===t.target.tagName?t.target.id:t.target.parentElement.id;this.$emit("completed",Number(s),new Date)},strftime:a}},c=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",{staticClass:"progress-indicator"},t._l(t.steps,function(s,n){return e("li",{key:n,class:{completed:s.timestamp,completed_right:s.timestamp&&n+1<t.steps.length&&t.steps[n+1].timestamp,completed_left:s.timestamp&&n>0&&t.steps[n-1].timestamp}},[e("span",{staticClass:"bubble",attrs:{id:n},on:{click:function(s){return s.preventDefault(),t.completed(s)}}},[e("transition",{attrs:{name:"custom-classes-transition","enter-active-class":"animated bounceInLeft"}},[s.action?e("i",{key:"icon",class:s.action}):t._e()])],1),e("span",{staticClass:"text"},[e("div",[e("span",[t._v(t._s(s.text))]),e("transition",{attrs:{name:"custom-classes-transition","enter-active-class":"animated bounceInLeft"}},[s.timestamp?e("span",{key:"timestamp",staticClass:"time"},[t._v(t._s(null!==s.timestamp?t.strftime("%H:%M:%S",s.timestamp):""))]):t._e()])],1)])])}))},o=[],r=e("XyMi");function l(t){e("SUAc")}var p=!1,d=l,m="data-v-4fd96d51",u=null,f=Object(r["a"])(i,c,o,p,d,m,u),g=f.exports,h=e("DmT9"),_=e.n(h),v={name:"app",components:{ShippingProgress:g},data:function(){return{fake_blockchain:!1,transaction_in_progress:null,contract:{address:null,steps:[{timestamp:null,text:"Order Placed"},{timestamp:null,text:"Smart Contract Confirmed"},{timestamp:null,text:"Processing Order"},{timestamp:null,text:"Order Finalization"},{timestamp:null,text:"Order Completed"},{timestamp:null,text:"Contract Resolved"}]},socket:_()()}},mounted:function(){var t=this;console.log("mounted");var s=this;this.socket.on("data",function(e){t.transaction_in_progress=null,console.log("received data "+JSON.stringify(e)),s.fake_completed(e.step,new Date)}),this.socket.on("new contract",function(e){t.transaction_in_progress=null,console.log("new contract deployed "+e.address),e&&e.address?(s.reset(),s.contract.address=e.address):console.error("Ignoring new and imcomplete contract")}),this.socket.on("status changed",function(e){if(console.log("status changed "+e.address),t.transaction_in_progress=null,e&&e.address&&s.contract.address==e.address){var n=new Date;n.setTime(e.timestamp),s.fake_completed(e.step,n)}else console.error("Ignoring status update with wrong contract address")}),this.socket.on("ACK",function(s){console.log("ACK "+s),t.transaction_in_progress=s})},methods:{emit:function(t,s,e){if(console.log("emit :"+t),!this.transaction_in_progress)return this.transaction_in_progress="submitted "+t,this.socket.emit(t,s,e)},advance:function(){console.log("advance");for(var t=0;t<this.contract.steps.length;t++)if(!this.contract.steps[t].timestamp)break;this.emit("advance",t,function(t){console.log(t)})},order:function(){console.log("place order"),this.emit("place order",null,function(t){console.log(t)})},ready_to_accept:function(){return this.contract.steps.slice(0,-1).reduce(function(t,s){return t&&s.timestamp},!0)&&!this.contract.steps[this.contract.steps.length-1].timestamp},accept:function(){console.log("accept order"),this.ready_to_accept()&&this.emit("advance",this.contract.steps.length-1,function(t){console.log(t)})},reset:function(){this.fake_completed(0,null)},fake_completed:function(t,s){if(t<0||t>=this.contract.steps.length)throw"ignoring illegal idx "+t;if(0===t&&this.contract.steps[t].timestamp){console.log("reseting status"),this.contract.address=null;for(var e=0;e<this.contract.steps.length;e+=1)this.contract.steps[e].timestamp=null,this.contract.steps[e].action=null}else{if(t>0&&null===this.contract.steps[t-1].timestamp)throw"ignoring update of idx "+t+", complete the previous entry first";if(null!==this.contract.steps[t].timestamp)throw"ignoring update of idx "+t+", already up to date";this.contract.steps[t].timestamp=s,0===t?(console.log("updating action"),this.contract.steps[t].action="fa fa-shopping-cart"):1===t?this.contract.steps[t].action="fa fa-search":2===t?this.contract.steps[t].action="fa fa-tag":3===t?this.contract.steps[t].action="fa fa-truck":4===t?this.contract.steps[t].action="fa fa-home":5===t&&(this.contract.steps[t].action="fa fa-check")}}}},C=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"app container"}},[t.contract.address?t._e():e("div",{staticClass:"overlay"},[e("div",{staticClass:"white"}),e("button",{staticClass:"btn btn-lg order text-uppercase",on:{click:function(s){return s.preventDefault(),t.order(s)}}},[t.transaction_in_progress?e("i",{staticClass:"fa fa-spinner fa-spin"}):e("i",{staticClass:"fa fa-shopping-cart"}),t._v("\n            Place order")])]),t.ready_to_accept()?e("div",{staticClass:"overlay"},[e("div",{staticClass:"white"}),e("button",{staticClass:"btn btn-lg order text-uppercase",on:{click:function(s){return s.preventDefault(),t.accept(s)}}},[t.transaction_in_progress?e("i",{staticClass:"fa fa-spinner fa-spin"}):e("i",{staticClass:"fa fa-check"}),t._v("\n            Accpet order")])]):t._e(),t._m(0),e("div",{staticClass:"row indentL"},[e("div",{staticClass:"col col-sm-3 headerL"},[t.contract.steps[0].timestamp?e("button",{staticClass:"btn cancel text-uppercase",on:{click:function(s){return s.preventDefault(),t.reset(s)}}},[t.contract.steps[t.contract.steps.length-1].timestamp?e("span",[e("i",{staticClass:"fa fa-undo"}),t._v(" Start again")]):e("span",[e("i",{staticClass:"fa fa-times"}),t._v(" Cancel")])]):t._e()])]),e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("ShippingProgress",{attrs:{steps:t.contract.steps},on:{completed:t.fake_completed}})],1)]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.transaction_in_progress,expression:"transaction_in_progress"}],staticClass:"progress"},[e("button",{staticClass:"btn btn-light"},[e("i",{staticClass:"fa fa-spinner fa-spin"}),t._v(" "+t._s(t.transaction_in_progress)+"\n        ")])])])},k=[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"row"},[n("div",{staticClass:"col headerL"},[n("img",{staticClass:"logo",attrs:{src:e("3qvW")}})])])}];function b(t){e("+VGo")}var w=!1,x=b,y=null,S=null,D=Object(r["a"])(v,C,k,w,x,y,S),O=D.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t(O)}}).$mount("#app")},SUAc:function(t,s){}},[0]);
//# sourceMappingURL=app.3fdaff60.js.map